function set_votes(a){var b=$(a).data("fsr").whole_avg,c=$(a).data("fsr").number_votes,d=$(a).data("fsr").dec_avg,e=$(a).data("fsr").error;$(a).find(".star_"+b).prevAll().andSelf().addClass("ratings_vote"),$(a).find(".star_"+b).nextAll().removeClass("ratings_vote"),$(a).find(".total_votes").text(c+" votes recorded ("+d+" rating)"),$(a).find(".rating_error").text(e)}$(document).ready(function(){$(".rate_widget").each(function(a){var b=this,c={f_article_number:$(b).attr("id")};$.post("/rating/show",c,function(a){$(b).data("fsr",a),set_votes(b)},"json")}),$(".ratings_stars").hover(function(){$(this).prevAll().andSelf().addClass("ratings_over"),$(this).nextAll().removeClass("ratings_vote")},function(){$(this).prevAll().andSelf().removeClass("ratings_over"),set_votes($(this).parent())}),$(".ratings_stars").bind("click",function(){var a=this,b=$(this).parent(),c=$(a).attr("class").match(/star_(\d+)/)[1],d={f_rating_score:c,f_article_number:$(a).parent().attr("id")};$.post("/rating/save",d,function(a){b.data("fsr",a),set_votes(b)},"json")})});